# 操作系统
## 1. 线程与进程
### 进程与线程的区别：
* 根本区别： 进程是操作系统资源分配的基本单位，而线程是处理器任务调度和执行的基本单位
* 资源开销:  每个进程都有独立的代码和数据空间(程序上下文)，程序之间的切换会有较大的开销；线程可以看做轻量级的进程，同一类线程共享代码和数据空间；每个线程都有自己独立的运行栈和程序计数器（PC），线程之间切换的开销小
* 内存分配： 同一进程的线程共享本进程的地址空间和资源，而进程之间的地址空间和资源是相互独立的
* 包含关系： 如果一个进程内有多个线程，则执行过程不是一条线，而是多条线（线程）共同完成的；线程是进程的一部分
* 与进程不同的是同类的多个线程共享进程的**堆**和**方法区**资源，但每个线程有自己的**程序计数器**、**虚拟机栈**和**本地方法栈**，所以系统在产生一个线程，或是在各个线程之间作切换工作时，负担要比进程小得多，也正因为如此，线程也被称为轻量级进程

### 协程
> 协程是一种用户态的轻量级线程，server的发展如下：IO密集型应用：多进程 -> 多线程 ->事件驱动 ->协程 
> 协程拥有自己的寄存器上下文和栈，协程调度切换时，将寄存器上下文和栈保存到其他地方，然后去做其他工作，当你的IO解除之后切回原来的状态，恢复先前保存的寄存器上下文和栈。
#### 优点：
* 跨平台
* 无需线程上下文切换的开销
* 无需原子操作锁定及同步的开销
* 方便切换控制流，简化流程模型
* 高并发+高扩展行+低成本： 一个CPU支持上万的协程都不是问题，所以很适合用于高并发处理

#### 缺点：
* 无法利用多核资源：协程本质是一个单线程，他不能同时将单个CPU的多个核作用上，协程需要和进程配合才能运行在多CPU上.
* 进行阻塞(Blocking)操作会阻塞到整个程序; 这一点和事件驱动一样，可以使用异步IO操作来解决

## 2. 进程间通信
> 首先要知道进程之间为什么要通信。 进程是一个独立的资源分配单元，不同进程（这里所说的进程通常指的是用户进程）之间的资源是独立的，没有关联，不能在一个进程中直接访问另一个进程的资源（例如打开的文件描述符）。 但是，进程不是孤立的，不同的进程需要进行信息的交互和状态的传递等，因此需要进程之间的通信。
### 进程通信的目的
* 数据传输：一个进程需要将它的数据发送给另一个进程
* 通知事件： 一个进程需要向另一个或一组进程发送消息，通知它（们）发生了某种事件
* 资源共享： 多个进程之间共享同样的资源，为了做到这一点需要内核提供互斥和同步机制
* 进程控制： 有些进程希望完全控制另一个进程的执行（如 Debug 进程），此时控制进程希望能够拦截另一个进程的所有陷入和异常，并能够及时知道它的状态改变。

### 通信方式
#### 管道
* 普通管道： 通常有两种限制，一种是单工，只能单向传输；二是只能在父子或兄弟进程间使用
* 流管道： 去除了第一种限制，为半双工，但依然智能在父子或兄弟进程间使用，可以双向传输
* 命名管道：去除了第二种限制,可以在许多并不相关的进程之间进行通讯

#### 信号量
* 信号量是一个计数器，可以用来控制多个进程对共享资源的访问
* 常作为一种锁机制，防止某个进程正在访问共享资源时，其他进程也访问
* 因此主要作为进程间基统一进程内不同线程的同步手段

#### 消息队列
> 消息队列是由消息构成的链表，存放在内核中并由消息队列标识符标识
